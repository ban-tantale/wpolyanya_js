<!DOCTYPE html>
<html>

<body>
    <canvas id="myCanvas" width="800" height="6s00" style="border:1px solid grey"></canvas>

    <div id="debug"></div>

    <script src="debug.js"></script>
    <script src="maps.js"></script>
    <script src="geometry.js"></script>
    <script src="camera.js"></script>
    <script src="tests.js"></script>
    <script>

        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');
        ctx.fillStyle = '#FF0000';
        canvas.height = canvas.width;
        ctx.transform(1, 0, 0, -1, 0, canvas.height)

        const camera = new Camera(ctx);

        function click(event) {
            const p = camera.point_of_event(event);
            camera.set_point_colour('#FF0000');
            camera.set_point_width(100);
            camera.draw_point(p);
            const poly = map.containing_poly(p);
            if (poly == null) {
                alert('No polygon!');
            } else {
                camera.set_poly_colour('#00FFFF');
                camera.draw_poly(poly);
            }
        }
        canvas.addEventListener('click', test_relative_click);

        function deal_with_keys(event) {
            let modified = false;
            if (event.code == 'ArrowLeft') { camera.left(); }
            else if (event.code == 'ArrowRight') { camera.right(); }
            else if (event.code == 'ArrowUp') { camera.up(); }
            else if (event.code == 'ArrowDown') { camera.down(); }
            else if (event.shiftKey && (event.code == 'KeyZ')) { camera.unzoom(); }
            else if (event.code == 'KeyZ') { camera.zoom(); }
            else {
                return;
            }

            camera.clear();
            camera.draw_map(map);
        }
        onkeyup = deal_with_keys;

        const pp = complex_map();
        const map = new Map(pp[0], pp[1]);
        camera.compute_weight_colours(map);
        camera.draw_map(map);

        window.alert('coucou');
    </script>

</body>

</html>